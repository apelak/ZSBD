CREATE TABLE LEKARZE (
    lekarz_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    imie VARCHAR2(50),
    nazwisko VARCHAR2(50),
    specjalizacja VARCHAR2(50),
    nr_pwz VARCHAR2(7) UNIQUE,
    stawka_bazowa NUMBER
);

CREATE TABLE GRAFIK_PRACY (
    grafik_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    lekarz_id NUMBER REFERENCES LEKARZE(lekarz_id),
    dzien_tygodnia NUMBER(1) CHECK (dzien_tygodnia BETWEEN 1 AND 7), -- 1 = Poniedzia≈Çek, 7=Niedziela
    godzina_od NUMBER(2) CHECK (godzina_od BETWEEN 0 AND 23),
    godzina_do NUMBER(2) CHECK (godzina_do BETWEEN 0 AND 23),
    CONSTRAINT chk_godziny CHECK (godzina_od < godzina_do)
);

CREATE TABLE PACJENCI (
    pacjent_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    imie VARCHAR2(50),
    nazwisko VARCHAR2(50),
    pesel VARCHAR2(11) UNIQUE,
    telefon VARCHAR2(20),
    email VARCHAR2(100),
    data_urodzenia DATE
);

CREATE TABLE WIZYTY (
    wizyta_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    pacjent_id NUMBER REFERENCES PACJENCI(pacjent_id),
    lekarz_id NUMBER REFERENCES LEKARZE(lekarz_id),
    data_wizyty DATE NOT NULL,
    status VARCHAR2(20) DEFAULT 'UMOWIONA' CHECK (status IN ('UMOWIONA', 'ZAKONCZONA', 'ANULOWANA')),
    koszt NUMBER(10,2),
    notatka_lekarska CLOB
);

CREATE TABLE RECEPTY (
    recepta_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    wizyta_id NUMBER REFERENCES WIZYTY(wizyta_id),
    data_wystawienia DATE DEFAULT SYSDATE,
    kod_dostepu VARCHAR2(4)
);

CREATE TABLE RECEPTY_POZYCJE (
    poz_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    recepta_id NUMBER REFERENCES RECEPTY(recepta_id),
    nazwa_leku VARCHAR2(100),
    dawkowanie VARCHAR2(100)
);

CREATE TABLE LOGI_AUDYTOWE (
    log_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    uzytkownik VARCHAR2(50),
    data_zdarzenia TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    operacja VARCHAR2(50),
    szczegoly VARCHAR2(4000)
);

CREATE TABLE ARCHIWUM_WIZYT (
    arch_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    wizyta_id NUMBER,
    data_archiwizacji DATE,
    powod VARCHAR2(200),
    stare_dane VARCHAR2(4000) 
);