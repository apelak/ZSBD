DROP TABLE JOB_HISTORY 
DROP TABLE REGIONS CASCADE CONSTRAINTS
DROP TABLE COUNTRIES CASCADE CONSTRAINTS
DROP TABLE JOBS CASCADE CONSTRAINTS
DROP TABLE EMPLOYEES CASCADE CONSTRAINTS
DROP TABLE LOCATIONS CASCADE CONSTRAINTS
DROP TABLE DEPARTMENTS CASCADE CONSTRAINTS

TABLE_NAME|
----------+

CREATE TABLE COUNTRIES AS SELECT * FROM HR.COUNTRIES
CREATE TABLE DEPARTMENTS AS SELECT * FROM HR.DEPARTMENTS
CREATE TABLE EMPLOYEES AS SELECT * FROM HR.EMPLOYEES 
CREATE TABLE JOBS AS SELECT * FROM HR.JOBS
CREATE TABLE JOB_GRADES AS SELECT * FROM HR.JOB_GRADES
CREATE TABLE JOB_HISTORY AS SELECT * FROM HR.JOB_HISTORY
CREATE TABLE LOCATIONS AS SELECT * FROM HR.LOCATIONS
CREATE TABLE PRODUCTS AS SELECT * FROM HR.PRODUCTS
CREATE TABLE REGIONS AS SELECT * FROM HR.REGIONS
CREATE TABLE SALES AS SELECT * FROM HR.SALES

ALTER TABLE COUNTRIES 
ADD CONSTRAINT COUNTRY_C_ID_PK
PRIMARY KEY (COUNTRY_ID)

ALTER TABLE DEPARTMENTS 
ADD CONSTRAINT DEPT_ID_PK 
PRIMARY KEY (DEPARTMENT_ID)

ALTER TABLE EMPLOYEES 
ADD CONSTRAINT EMP_EMAIL_ID_PK
PRIMARY KEY (EMPLOYEE_ID)

ALTER TABLE JOBS
ADD CONSTRAINT JOB_ID_PK
PRIMARY KEY (JOB_ID)

ALTER TABLE JOB_HISTORY 
ADD CONSTRAINT JHIST_EMP_ID_ST_DATE_PK
PRIMARY KEY (EMPLOYEE_ID, START_DATE)

ALTER TABLE LOCATIONS
ADD CONSTRAINT LOC_ID_PK
PRIMARY KEY (LOCATION_ID)

ALTER TABLE PRODUCTS 
ADD CONSTRAINT PROD_ID_PK
PRIMARY KEY (PRODUCT_ID)

ALTER TABLE JOB_GRADES 
ADD CONSTRAINT JGRAD_GRAD_PK
PRIMARY KEY (GRADE)

ALTER TABLE REGIONS
ADD CONSTRAINT REG_ID_PK
PRIMARY KEY (REGION_ID)

ALTER TABLE SALES
ADD CONSTRAINT SAL_ID_PK
PRIMARY KEY (SALE_ID)

ALTER TABLE COUNTRIES 
ADD CONSTRAINT COUN_REG_FK
FOREIGN KEY (REGION_ID)
REFERENCES REGIONS(REGION_ID)

ALTER TABLE LOCATIONS 
ADD CONSTRAINT LOC_COUN_FK
FOREIGN KEY (COUNTRY_ID)
REFERENCES COUNTRIES(COUNTRY_ID)

ALTER TABLE DEPARTMENTS 
ADD CONSTRAINT DEP_LOC_FK
FOREIGN KEY (LOCATION_ID)
REFERENCES LOCATIONS(LOCATION_ID)

ALTER TABLE DEPARTMENTS 
ADD CONSTRAINT DEP_EMPL_FK
FOREIGN KEY (MANAGER_ID)
REFERENCES EMPLOYEES(EMPLOYEE_ID)

ALTER TABLE EMPLOYEES 
ADD CONSTRAINT EMPL_EMPL_FK
FOREIGN KEY (MANAGER_ID)
REFERENCES EMPLOYEES(EMPLOYEE_ID)

ALTER TABLE EMPLOYEES 
ADD CONSTRAINT EMPL_DEP_FK
FOREIGN KEY (DEPARTMENT_ID)
REFERENCES DEPARTMENTS(DEPARTMENT_ID)

ALTER TABLE EMPLOYEES 
ADD CONSTRAINT EMPL_JOB_FK
FOREIGN KEY (JOB_ID)
REFERENCES JOBS(JOB_ID)

ALTER TABLE JOB_HISTORY 
ADD CONSTRAINT JOBHIS_EMP_FK
FOREIGN KEY (EMPLOYEE_ID)
REFERENCES EMPLOYEES(EMPLOYEE_ID)

ALTER TABLE JOB_HISTORY 
ADD CONSTRAINT JOBHIS_JOB_FK
FOREIGN KEY (JOB_ID)
REFERENCES JOBS(JOB_ID)

ALTER TABLE JOB_HISTORY 
ADD CONSTRAINT JOBHIS_DEP_FK
FOREIGN KEY (DEPARTMENT_ID)
REFERENCES DEPARTMENTS(DEPARTMENT_ID)

ALTER TABLE SALES
ADD CONSTRAINT SAL_PRD_FK
FOREIGN KEY (PRODUCT_ID)
REFERENCES PRODUCTS(PRODUCT_ID)

##ZADANIE 1
SELECT LAST_NAME||' '||SALARY AS NAZWISKO_I_ZAROBKI
FROM EMPLOYEES e 
WHERE 1=1
AND DEPARTMENT_ID IN (20, 50)
AND SALARY BETWEEN 2000 AND 7000

NAZWISKO_I_ZAROBKI|
------------------+
Vollman 6500      |
Mourgos 5800      |
Nayer 3200        |
Mikkilineni 2700  |
Landry 2400       |
Markle 2200       |
Bissot 3300       |
Atkinson 2800     |
Marlow 2500       |
Olson 2100        |
Mallin 3300       |
Rogers 2900       |
Gee 2400          |
Philtanker 2200   |
Ladwig 3600       |
Stiles 3200       |
Seo 2700          |
Patel 2500        |
Rajs 3500         |
Davies 3100       |
Matos 2600        |
Vargas 2500       |
Taylor 3200       |
Fleaur 3100       |
Sullivan 2500     |
Geoni 2800        |
Sarchand 4200     |
Bull 4100         |
Dellinger 3400    |
Cabrio 3000       |
Chung 3800        |
Dilly 3600        |
Gates 2900        |
Perkins 2500      |
Bell 4000         |
Everett 3900      |
McCain 3200       |
Jones 2800        |
Walsh 3100        |
Feeney 3000       |
OConnell 2600     |
Grant 2600        |
Fay 6000          |


##ZADANIE 2
SELECT HIRE_DATE,
	LAST_NAME,
	&kolumna
FROM EMPLOYEES e 
WHERE 1=1
AND MANAGER_ID IS NOT NULL 
AND EXTRACT(YEAR FROM hire_date) = 2005
ORDER BY &kolumna

