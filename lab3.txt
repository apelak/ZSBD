##ZADANIE 1

CREATE VIEW v_wysokie_pensje AS 
SELECT * FROM EMPLOYEES 
WHERE 1=1
AND salary > 6000
WITH CHECK OPTION 

##ZADANIE 2

CREATE OR REPLACE VIEW v_wysokie_pensje AS 
SELECT * FROM EMPLOYEES 
WHERE 1=1
AND salary > 12000
WITH CHECK OPTION 

##ZADANIE 3

DROP VIEW v_wysokie_pensje

##ZADANIE 4

CREATE VIEW v_employees_fin AS 
SELECT  e.employee_id, e.last_name, e.first_name
FROM EMPLOYEES e
JOIN DEPARTMENTS d  ON e.department_id = d.department_id
WHERE 1=1
AND d.department_name = 'Finance'

##ZADANIE 5

CREATE OR REPLACE VIEW v_employees_5k_12k AS 
SELECT employee_id, last_name, first_name, salary, job_id, email, hire_date
FROM EMPLOYEES
WHERE 1=1
AND salary BETWEEN 5000 AND 12000

##ZADANIE 6

a) tak , jezeli with check option to tylko w danym zakresie, jezeli join to nie 
b) tak , jezeli with check option to tylko w danym zakresie, jezeli join to nie
c) tak , jezeli join to nie 

##ZADANIE 7

CREATE OR REPLACE VIEW v_departments_4emp AS
SELECT d.department_id, d.department_name,
    COUNT(e.employee_id) AS liczba_pracownikow,
    ROUND(AVG(e.salary), 2) AS srednia_pensja,
    MAX(e.salary) AS najwyzsza_pensja
FROM 
    departments d
JOIN 
    employees e ON d.department_id = e.department_id
GROUP BY 
    d.department_id, d.department_name
HAVING 
    COUNT(e.employee_id) >= 4

 INSERT INTO v_departments_4emp VALUES (200,'lolo', 23, 2500, 10000)
SQL Error [1779] [42000]: ORA-01779: cannot modify a column which maps to a non key-preserved table

##ZADANIE 8

CREATE OR REPLACE VIEW v_employees_5k_12k AS 
SELECT employee_id, last_name, first_name, salary, job_id, email, hire_date
FROM EMPLOYEES
WHERE 1=1
AND salary BETWEEN 5000 AND 12000
WITH CHECK OPTION
a) tak 
b) nie

##ZADANIE 9

CREATE MATERIALIZED VIEW v_managerowie
BUILD IMMEDIATE
REFRESH COMPLETE ON DEMAND
AS
SELECT DISTINCT 
m.EMPLOYEE_ID AS MANAGER_ID,
m.FIRST_NAME,
m.LAST_NAME,
d.DEPARTMENT_NAME
FROM PELAKA.EMPLOYEES e
JOIN PELAKA.EMPLOYEES m ON e.MANAGER_ID = m.EMPLOYEE_ID
LEFT JOIN PELAKA.DEPARTMENTS d ON m.DEPARTMENT_ID = d.DEPARTMENT_ID;


##ZADANIE 10

SELECT * FROM EMPLOYEES 
ORDER BY salary DESC 
FETCH FIRST 10 ROWS ONLY




















